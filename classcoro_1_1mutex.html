<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libcoro: coro::mutex Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libcoro
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Coroutine support library for C++20</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacecoro.html">coro</a></li><li class="navelem"><a class="el" href="classcoro_1_1mutex.html">mutex</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-static-methods">Static Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classcoro_1_1mutex-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">coro::mutex Class Reference<div class="ingroups"><a class="el" href="group__awaitable.html">Awaitables</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Mutex which allows locking across <b>co_await</b> and <b>co_yield</b> suspend points.  
 <a href="classcoro_1_1mutex.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="mutex_8h_source.html">mutex.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcoro_1_1mutex_1_1ownership.html">ownership</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">tracks ownership  <a href="classcoro_1_1mutex_1_1ownership.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1b5fb2fd2995e2210181de3c4211ca6f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcoro_1_1mutex_1_1ownership.html">ownership</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcoro_1_1mutex_a1b5fb2fd2995e2210181de3c4211ca6f.html#a1b5fb2fd2995e2210181de3c4211ca6f">try_lock</a> ()</td></tr>
<tr class="memdesc:a1b5fb2fd2995e2210181de3c4211ca6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">try to lock  <a href="classcoro_1_1mutex_a1b5fb2fd2995e2210181de3c4211ca6f.html#a1b5fb2fd2995e2210181de3c4211ca6f">More...</a><br /></td></tr>
<tr class="separator:a1b5fb2fd2995e2210181de3c4211ca6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09acdcaaaf6689b7c5fcdf272448aab8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcoro_1_1future.html">future</a>&lt; <a class="el" href="classcoro_1_1mutex_1_1ownership.html">ownership</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcoro_1_1mutex_a09acdcaaaf6689b7c5fcdf272448aab8.html#a09acdcaaaf6689b7c5fcdf272448aab8">lock</a> ()</td></tr>
<tr class="memdesc:a09acdcaaaf6689b7c5fcdf272448aab8"><td class="mdescLeft">&#160;</td><td class="mdescRight">lock the mutex, retrieve future ownership  <a href="classcoro_1_1mutex_a09acdcaaaf6689b7c5fcdf272448aab8.html#a09acdcaaaf6689b7c5fcdf272448aab8">More...</a><br /></td></tr>
<tr class="separator:a09acdcaaaf6689b7c5fcdf272448aab8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaba66eafc692c884b16176f985bec78"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcoro_1_1future.html">future</a>&lt; <a class="el" href="classcoro_1_1mutex_1_1ownership.html">ownership</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcoro_1_1mutex_aeaba66eafc692c884b16176f985bec78.html#aeaba66eafc692c884b16176f985bec78">operator co_await</a> ()</td></tr>
<tr class="memdesc:aeaba66eafc692c884b16176f985bec78"><td class="mdescLeft">&#160;</td><td class="mdescRight">lock the mutex co_awaitable  <a href="classcoro_1_1mutex_aeaba66eafc692c884b16176f985bec78.html#aeaba66eafc692c884b16176f985bec78">More...</a><br /></td></tr>
<tr class="separator:aeaba66eafc692c884b16176f985bec78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0067038a6413cc3c34bfca3a8ef63314"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcoro_1_1mutex_1_1ownership.html">ownership</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcoro_1_1mutex_a0067038a6413cc3c34bfca3a8ef63314.html#a0067038a6413cc3c34bfca3a8ef63314">lock_sync</a> ()</td></tr>
<tr class="memdesc:a0067038a6413cc3c34bfca3a8ef63314"><td class="mdescLeft">&#160;</td><td class="mdescRight">lock synchronously  <a href="classcoro_1_1mutex_a0067038a6413cc3c34bfca3a8ef63314.html#a0067038a6413cc3c34bfca3a8ef63314">More...</a><br /></td></tr>
<tr class="separator:a0067038a6413cc3c34bfca3a8ef63314"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ae9c73d87232d3dd22e4dd45c0719206e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcoro_1_1mutex_ae9c73d87232d3dd22e4dd45c0719206e.html#ae9c73d87232d3dd22e4dd45c0719206e">try_acquire</a> ()</td></tr>
<tr class="memdesc:ae9c73d87232d3dd22e4dd45c0719206e"><td class="mdescLeft">&#160;</td><td class="mdescRight">tries to acquire  <a href="classcoro_1_1mutex_ae9c73d87232d3dd22e4dd45c0719206e.html#ae9c73d87232d3dd22e4dd45c0719206e">More...</a><br /></td></tr>
<tr class="separator:ae9c73d87232d3dd22e4dd45c0719206e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a332daa03fef87a9174c026bee2f7aaa0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcoro_1_1promise.html">promise</a>&lt; <a class="el" href="classcoro_1_1mutex_1_1ownership.html">ownership</a> &gt;::notify&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcoro_1_1mutex_a332daa03fef87a9174c026bee2f7aaa0.html#a332daa03fef87a9174c026bee2f7aaa0">do_lock</a> (<a class="el" href="classcoro_1_1future.html">future</a>&lt; <a class="el" href="classcoro_1_1mutex_1_1ownership.html">ownership</a> &gt; *fut_awt)</td></tr>
<tr class="memdesc:a332daa03fef87a9174c026bee2f7aaa0"><td class="mdescLeft">&#160;</td><td class="mdescRight">initiate lock operation  <a href="classcoro_1_1mutex_a332daa03fef87a9174c026bee2f7aaa0.html#a332daa03fef87a9174c026bee2f7aaa0">More...</a><br /></td></tr>
<tr class="separator:a332daa03fef87a9174c026bee2f7aaa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62a4ba298325045f272db9ea9c2e5098"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcoro_1_1mutex_a62a4ba298325045f272db9ea9c2e5098.html#a62a4ba298325045f272db9ea9c2e5098">build_queue</a> (awaiter *r, awaiter *stop)</td></tr>
<tr class="memdesc:a62a4ba298325045f272db9ea9c2e5098"><td class="mdescLeft">&#160;</td><td class="mdescRight">builds internal queue  <a href="classcoro_1_1mutex_a62a4ba298325045f272db9ea9c2e5098.html#a62a4ba298325045f272db9ea9c2e5098">More...</a><br /></td></tr>
<tr class="separator:a62a4ba298325045f272db9ea9c2e5098"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad61eb6f932856d72ed42b083480fcd6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcoro_1_1promise.html">promise</a>&lt; <a class="el" href="classcoro_1_1mutex_1_1ownership.html">ownership</a> &gt;::notify&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcoro_1_1mutex_aad61eb6f932856d72ed42b083480fcd6.html#aad61eb6f932856d72ed42b083480fcd6">unlock</a> ()</td></tr>
<tr class="memdesc:aad61eb6f932856d72ed42b083480fcd6"><td class="mdescLeft">&#160;</td><td class="mdescRight">unlock the lock  <a href="classcoro_1_1mutex_aad61eb6f932856d72ed42b083480fcd6.html#aad61eb6f932856d72ed42b083480fcd6">More...</a><br /></td></tr>
<tr class="separator:aad61eb6f932856d72ed42b083480fcd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab59c072bf2835eff157b8c59adf1c0ad"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcoro_1_1mutex_1_1ownership.html">ownership</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcoro_1_1mutex_ab59c072bf2835eff157b8c59adf1c0ad.html#ab59c072bf2835eff157b8c59adf1c0ad">make_ownership</a> ()</td></tr>
<tr class="memdesc:ab59c072bf2835eff157b8c59adf1c0ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">creates ownership object  <a href="classcoro_1_1mutex_ab59c072bf2835eff157b8c59adf1c0ad.html#ab59c072bf2835eff157b8c59adf1c0ad">More...</a><br /></td></tr>
<tr class="separator:ab59c072bf2835eff157b8c59adf1c0ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-static-methods"></a>
Static Protected Member Functions</h2></td></tr>
<tr class="memitem:a6d73b5920fdf3bd9e2959a26ffb20402"><td class="memItemLeft" align="right" valign="top">static awaiter *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcoro_1_1mutex_a6d73b5920fdf3bd9e2959a26ffb20402.html#a6d73b5920fdf3bd9e2959a26ffb20402">locked</a> ()</td></tr>
<tr class="memdesc:a6d73b5920fdf3bd9e2959a26ffb20402"><td class="mdescLeft">&#160;</td><td class="mdescRight">generates special pointer, which is used as locked flag (value 0x00000001)  <a href="classcoro_1_1mutex_a6d73b5920fdf3bd9e2959a26ffb20402.html#a6d73b5920fdf3bd9e2959a26ffb20402">More...</a><br /></td></tr>
<tr class="separator:a6d73b5920fdf3bd9e2959a26ffb20402"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a6699913b9e97fc8f728baf404674ecaf"><td class="memItemLeft" align="right" valign="top">std::atomic&lt; awaiter * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcoro_1_1mutex_a6699913b9e97fc8f728baf404674ecaf.html#a6699913b9e97fc8f728baf404674ecaf">_req</a> = {nullptr}</td></tr>
<tr class="separator:a6699913b9e97fc8f728baf404674ecaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a283b0c85b2776e768ed3ae13a4aca584"><td class="memItemLeft" align="right" valign="top">awaiter *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcoro_1_1mutex_a283b0c85b2776e768ed3ae13a4aca584.html#a283b0c85b2776e768ed3ae13a4aca584">_que</a> = nullptr</td></tr>
<tr class="memdesc:a283b0c85b2776e768ed3ae13a4aca584"><td class="mdescLeft">&#160;</td><td class="mdescRight">contains queue of requests already registered by the lock  <a href="classcoro_1_1mutex_a283b0c85b2776e768ed3ae13a4aca584.html#a283b0c85b2776e768ed3ae13a4aca584">More...</a><br /></td></tr>
<tr class="separator:a283b0c85b2776e768ed3ae13a4aca584"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Mutex which allows locking across <b>co_await</b> and <b>co_yield</b> suspend points. </p>
<p>This object can be used to hold exclusive access to a resource while the coroutine is suspended on <b>co_await</b> on <b>co_yield</b>. Standard mutex can't support such feature. This mutex is also co_awaitable.</p>
<p>The object suports lock and try_lock. However the lock protocol is different. When lock success, you receive an ownership object, which must be held to keep exclusive access. Once the ownership is released, the mutex is unlocked. The ownership object uses RAII to track to mutex ownership. So there is no explicit <a class="el" href="classcoro_1_1mutex_aad61eb6f932856d72ed42b083480fcd6.html#aad61eb6f932856d72ed42b083480fcd6" title="unlock the lock">unlock()</a> function.</p>
<p>The mutex object support <b>co_await</b>, <a class="el" href="classcoro_1_1mutex_a0067038a6413cc3c34bfca3a8ef63314.html#a0067038a6413cc3c34bfca3a8ef63314" title="lock synchronously">lock_sync()</a></p>
<p>Attempt to lock the mutex always return a future with ownership. </p>

<p class="definition">Definition at line <a class="el" href="mutex_8h_source.html#l00030">30</a> of file <a class="el" href="mutex_8h_source.html">mutex.h</a>.</p>
</div><hr/>The documentation for this class was generated from the following file:<ul>
<li>src/coro/<a class="el" href="mutex_8h_source.html">mutex.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun May 12 2024 14:01:18 for libcoro by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
